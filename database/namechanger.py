import sqlite3
import json
# Connect to your database
connection = sqlite3.connect("./database/ecommerce.db")  # Replace with your actual database file
cursor = connection.cursor()

def update_products(new_values):
    """
    Updates the product name and base price starting from index 0.

    :param new_values: List of tuples, each containing (new_name, new_price).
    """
    # Fetch all rows sorted by name
    cursor.execute("SELECT product_id, name FROM products_main ORDER BY name")
    rows = cursor.fetchall()
    print(rows)
    
    # Update rows based on the new_values list
    for i, (new_name, new_price) in enumerate(new_values):
        if i < len(rows):  # Check to avoid out-of-range index
            product_id = rows[i][0]
            query = "UPDATE products_main SET name = ?, base_price = ? WHERE product_id = ?"
            cursor.execute(query, (new_name, new_price, product_id))
        else:
            print(f"No more rows to update for index {i}. Skipping...")

    # Commit changes
    connection.commit()
    print("Product updates completed successfully.")

# Example usage
new_data = [
  ["Clear Lacon Sample Pots (100)", 11.99],
  ["Foldable Reusable Grocery Bags (10)", 14.99],
  ["Knotted Wide Headbands (10)", 9.99],
  ["Christmas Nail Art Stickers (10 Sheets)", 7.99],
  ["Neon 80s Sunglasses Pack (10/20)", 15.99],
  ["Smile Acrylic Keychain Set (100)", 8.99],
  ["Vintage Perfume Bottle (100ml)", 13.99],
  ["Arizona Bb Cognac Sandals", 79.99],
  ["Sunglasses 1014/S R60", 59.99],
  ["108 Labradorite Bead Mala", 18.99],
  ["10K Gold Diamond Cut Chain", 159.99],
  ["Travel Cosmetic Tubes (15ml x10)", 10.49],
  ["TS Eras Tour Bracelets (10pcs)", 12.99],
  ["Magnet Cat Eye Nail Tool Set (11pc)", 9.99],
  ["1oz Clear Empty Bottles (110 Pack)", 12.99],
  ["Small Rectangle Sunglasses (12 Pack)", 17.99],
  ["Visor Cap Pack (12)", 24.99],
  ["Beaded Boho Hoop Earrings (12 Pairs)", 14.99],
  ["Black Frosted Glass Jars (12)", 10.99],
  ["Foam Pool Noodles (12 Pcs)", 16.99],
  ["Straw Clutch Bags (12 Pack)", 25.99],
  ["Multi Shape AB Nail Rhinestones (120 Pcs)", 11.49],
  ["Spa Headband & Wrist Towels (12PCS)", 13.99],
  ["Reusable Magnetic Water Balloons (12)", 16.99],
  ["Stainless Steel Wedding Band (12mm)", 9.99],
  ["Black S Hooks (12pcs)", 7.99],
  ["Heavy Duty Carport (12x20)", 239.99],
  ["Medium Square Press-On Nails (1344pcs)", 14.99],
  ["Gold Plated CZ Hoop Earrings", 15.99],
  ["Gold Plated White Opal Necklace", 17.99],
  ["Gold Plated Leaf Dangle Earrings", 12.49],
  ["Gold/Silver Huggies Earring Set", 16.99],
  ["Plated Crescent Moon Necklace", 13.99],
  ["14k Gold Small Cross Pendant", 49.99],
  ["Rimless Star Sunglasses (15 Pairs)", 21.99],
  ["16 Inch Kids Electric Guitar Toy", 19.99],
  ["16G Industrial Barbell (Surgical Steel)", 10.49],
  ["16G Rook Curved Barbell Piercing", 8.99],
  ["16G Yin Yang Stud Earrings", 7.99],
  ["Industrial Barbell Mix (16PCS)", 12.99],
  ["Black Rubber Watch Strap (16mm)", 9.99],
  ["Nylon Tribal Watch Band (18-20mm)", 12.99],
  ["Kids Tool Set (18-Piece)", 29.99],
  ["Gold Plated Crystal Belt Bangle", 14.99],
  ["Gold Plated Small Hoop Earrings", 13.99],
  ["Gold Adjustable Knuckle Rings (18K)", 12.99],
  ["Toddler Girls Pants Set (18M-7T)", 16.99],
  ["Multi-Color Opal Spider Earrings (18k)", 11.99],
  ["Brown Leather Watchband (18mm)", 13.99],
  ["Clear Heart Perfume Necklace (1PC)", 9.99],
  ["1 Tier Crystal Pearl Veil (1T)", 14.99],
  ["Pink Dappen Dish Cups (2 Pack)", 6.99],
  ["Clothes Hanger Organizer (2 Pack)", 12.99],
  ["Kids Winter Thermal Underwear (2 Pack)", 18.99],
  ["Mini Blaster Gun Set (2 Pack)", 13.49],
  ["Neon Green Luggage Tags (2 Pack)", 7.49],
  ["Remote Teething Toys (2 Pack)", 8.99],
  ["Wooden Tie Rack (2 Pack)", 11.99],
  ["Acrylic Clutch Purse (2 Pcs)", 16.99],
  ["Open Cuff Bracelet Set (2 Pcs)", 9.99],
  ["Hip Hop Rhinestone Necklace (2 Pcs)", 15.99],
  ["Mini Handcuff Keychains (2 Pcs)", 6.99],
  ["Soccer Training Belt (2 Pcs)", 11.99],
  ["Braided Leather Belt (2 Pieces)", 13.99],
  ["Clear Pull-Out Organizer (2 Tier)", 23.99],
  ["2\" Necklace Extender", 5.99],
  ["Girls Mermaid Pajamas (2-Pack)", 17.99],
  ["2-in-1 Sorting Cup & Fishing Game", 14.99],
  ["4-Compartment Cupcake Boxes (20 Pack)", 15.49],
  ["Spa Party Robes (20 Pack)", 39.99],
  ["Spa Party Robes (20 Pack)", 39.99],
  ["Boys Solid Dress Socks (20 Pairs)", 18.99],
  ["Fleece Ear Warmer Headbands (20 Pcs)", 14.99],
  ["Nail Buffer Block (20 Pieces)", 7.99],
  ["LM2596 Buck Converter (20 pcs)", 19.99],
  ["Nerf Hyper Ammo (200 Rounds)", 12.99],
  ["2000W Power Converter 220 to 110", 39.99],
  ["Womenâ€™s Striped Sweater Cardigan (2023)", 27.99],
  ["Aluminum Jar Tins (20PCS 5ML)", 8.99],
  ["Refillable Plastic Soft Tubes (20PCS)", 12.49],
  ["Western Hat Boot Keychain (20PCS)", 15.99],
  ["220085 Black Shoe 9.5 Medium", 59.99],
  ["22G CZ Nose Studs (4PCS)", 8.99],
  ["Braided Leather Wristbands (24 PCS)", 13.99],
  ["Holographic Makeup Bags (24 Pcs)", 16.99],
  ["Thank You Keychains (24 Pcs)", 18.99],
  ["Thank You Keychains (24 Pcs)", 18.99],
  ["Toy Wheels & Axles 24x7mm (50 Pcs)", 9.99],
  ["24Vdc Power Supply NDR 120W", 29.99],
  ["2A AC/DC 9V Adapter", 7.99],
  ["Stainless Infinity Couple Bracelet (2PC)", 10.99],
  ["Grandpa Grandma EST 2023 Hats (2PCS)", 14.99],
  ["Rhinestone Magnetotherapy Hoop (2Pcs)", 9.99],
  ["Stainless Gothic Skull Earrings (2Pcs)", 6.49],
  ["Magnetic Hat Clip (2pcs)", 8.49],
  ["Sports Braided Bracelet (2pcs)", 6.99],
  ["2x4basics Custom Shed Kit", 59.99],
  ["Small Tool Bags (3 Pack)", 14.99],
  ["Men's Cotton Pajama Shorts (3 Pack)", 22.99],
  ["Gold Metal Dinosaur Earrings (3 Pairs)", 6.99],
  ["Christmas Leather Ball Purse (3 Pcs)", 19.99],
  ["Glass Cuticle Pusher Set (3 Pcs)", 7.49],
  ["Light Up Santa Cowboy Hat (3 Pcs)", 10.99],
  ["Stretchy Rhinestone Belt (3 Pieces)", 12.99],
  ["Outdoor Resin Deck Box (30 Gallon)", 49.99],
  ["30 Gallon Trash & Recycle Bins (3)", 45.99],
  ["Inspirational Makeup Bags (30 Pcs)", 25.99],
  ["Mini Perfume Spray Bottles (30 Pcs)", 9.99],
  ["30W DC Variable Power Supply", 24.99],
  ["Star Wars Stormtrooper Watch (31689)", 129.99],
  ["Gold Hoop Earring Set (34 Pairs)", 19.99],
  ["Acrylic Storage Jar 34oz", 10.99],
  ["Black 90s Retro Sunglasses (36 Pairs)", 32.99],
  ["3D Acrylic Flower Nail Charms", 9.99],
  ["3D Gravity Maze Puzzle Ball", 13.99],
  ["3D Strawberry Earring Necklace Set", 8.99],
  ["Unicorn Mermaid Backpack (3PCS)", 28.99],
  ["Fake Belly Button Rings (3Pcs)", 7.49],
  ["Rainbow Pride Wristbands (3pcs)", 5.99],
  ["Wood Tie Clips (4 PCS)", 8.99],
  ["Amber Roller Bottles (4 Pack)", 6.99],
  ["Plastic Closet Baskets (4 Pack)", 14.99],
  ["Women Wide Elastic Belt (4 Pack)", 13.99],
  ["Sterling Silver Studs Set (4 Pairs)", 12.99],
  ["Foot Jewelry Anklet Set (4 Pairs)", 9.49],
  ["Cartoon Food Earrings (4 Pairs)", 7.99],
  ["Men's Clip-on Ties (4 Pcs)", 11.99],
  ["Non Piercing Bra Chain (4 Pcs)", 10.49],
  ["Hijab Undercap Set (4 Pieces)", 8.49],
  ["Breast Cancer Awareness Gifts (4 Set)", 19.99],
  ["Girls Pajamas Set (4-Pack)", 24.99],
  ["Men's V-Neck T-Shirts (4-Pack)", 17.99],
  ["Inspirational Makeup Bags (40 Pcs)", 30.99],
  ["Christian Keychains (45 Pcs)", 21.99],
  ["Unisex Bucket Hats (48 Pieces)", 39.99],
  ["18G Nose Hoops (4PCS)", 9.99],
  ["Satin Hair Scarves (4PCS)", 8.99],
  ["Coated Stainless J Hooks (4Pcs)", 9.49],
  ["Large Square Scarf Set (4pc)", 14.99],
  ["Greek Goddess Leaf Headbands (5 PCS)", 9.99],
  ["Women's Seamless Hipster (5 Pack)", 14.99],
  ["Nail Brush-On Glue (5 Second, 3-Pack)", 7.99],
  ["Talking Watch for Men (5 Senses)", 24.99],
  ["5 Sports Automatic SRPE55K1", 199.99],
  ["5 Sports Automatic SRPE55K1", 199.99],
  ["Sterling Silver Number Charms", 12.99],
  ["Colorful Mesh Beach Bags (5-PCS)", 10.99],
  ["5-Panel Moisture Wicking Run Hat", 12.49],
  ["Mini AB Nail Crystals (5000PCs)", 9.99],
  ["Lint Free Nail Wipes (540Pcs)", 6.99],
  ["Bogg Bag Accessories (5Pcs)", 8.99],
  ["PET Liquid Bottles (100ml x5)", 7.99],
  ["Halloween Nail Art Stickers (6 PCS)", 6.49],
  ["Mold-Free Bath Toys (6 PCS)", 13.99],
  ["Womens Ribbed Underwear (6 Pack)", 15.99],
  ["Halloween Squishy Toys (6 Packs)", 17.99],
  ["Gold Hoop Earrings Set (6 Pairs)", 16.99],
  ["Men's Compression Socks 8-15mmHg (6)", 14.99],
  ["Women Pilates Grip Socks (6 Pairs)", 12.99],
  ["Clear Travel Toiletry Bags (6 Pcs)", 10.99],
  ["Pool Floaties for Girl Dolls (6 Pcs)", 9.49],
  ["Rhinestone Elastic Headbands (6)", 8.99],
  ["French Nail Trimmer Set (6 Pcs)", 7.99],
  ["Yin Yang Bracelets & Ring (6 pcs)", 9.99],
  ["Gold Cross Nail Charms (60 Pcs)", 8.99],
  ["Indoor/Outdoor Trampoline (60\")", 69.99],
  ["Inspirational Religious Keychains (64)", 18.99],
  ["Elastic Crystal Toe Rings (6pcs)", 6.99],
  ["WWJD Bracelets (70 Pieces)", 14.99],
  ["AB Nail Rhinestones (735 Pieces)", 12.99],
  ["Nail Art Liner Gel (7ml*2pcs)", 9.49],
  ["Collapsible Food Containers (8 Pack)", 17.99],
  ["Silk Dust Cover Bags (8 Pack)", 13.99],
  ["Butterfly Wing Earrings (8 Pairs)", 9.99],
  ["Women No Show Socks (8 Pairs)", 11.49],
  ["Sneaker Shoe Dust Bags (8 Pcs)", 12.99],
  ["Inflatable White Beach Balls (8)", 10.99],
  ["Packing Cubes + Shoe Bag (8 Set)", 21.99],
  ["Bridal Makeup Bag Set (8 pcs)", 16.99],
  ["Men's Sport Digital Watch (8007)", 15.99],
  ["Ear Cuff Cartilage Set (81 Pcs)", 13.99],
  ["Owl Lover Gift Set (8PCS)", 14.49],
  ["8oz Plastic Clear Bottles (6 Pack)", 6.99],
  ["Nail Magnet Tool Set (8pcs)", 8.49],
  ["Fedora Hats for Women (9 Pcs)", 23.99],
  ["Heart Cross Urn Necklaces (9 Pcs)", 20.99],
  ["911 Dispatcher Keychain Gift", 7.99],
  ["925 Silver 14K Butterfly Pendant", 24.99],
  ["925 Silver 18K Gold Flower Studs", 12.99],
  ["925 Silver Anxiety Spinner Ring", 17.49],
  ["925 Silver CZ Stud Earring Set", 13.99],
  ["925 Silver Couple Cross Shield Ring", 16.99],
  ["925 Silver CZ Baby Earrings", 11.99],
  ["925 Silver Cuff Chain Earrings", 12.49],
  ["925 Silver Minimalist Necklace", 15.99],
  ["925 Silver Plumeria Opal Ring", 18.99],
  ["925 Silver Lightning Screw Back Earrings", 14.99],
  ["925 Silver Pearl Leaf Ring", 19.99],
  ["925 Silver Snowflake Studs", 13.49],
  ["925-Sterling-Silver Adjustable Hug Ring", 10.99],
  ["\"A Woman's Place\" Makeup Bag", 7.99],
  ["ABO Gear Closet Organizers (3pc)", 16.99],
  ["AHAVA Dermud Hand Cream 3.4oz", 23.99],
  ["AKOAK Shell Nail Display Rack", 5.99],
  ["ALAMSCN USB Buck Converter (2PCS)", 8.99],
  ["ANDGING French Tip Press-On Nails", 9.99],
  ["ARIRO Baby Stacking Rings (Wood)", 14.99],
  ["AS440 Automatic Voltage Regulator", 36.99],
  ["ASHMITA Leather Teardrop Earrings", 8.49],
  ["Abgream Oval Silicone Butt Pads", 17.99],
  ["Academy Backpack (Cool Grey)", 29.99],
  ["Acrylic Semicircle Clutch Purse", 18.99],
  ["Action Sports Teva Sling Sandals", 39.99],
  ["Adjustable Gold Knuckle Rings", 13.99],
  ["Skeleton Bone Snapback Hat", 12.99],
  ["Foil & Wrap Adjustable Organizer", 15.99],
  ["Adjustable Shirt Collar Support", 8.99],
  ["Sports Visor Caps (12-pack)", 22.99],
  ["Little Girls Fall Cotton Dress", 14.99],
  ["Toddler Girls Winter Sweatsuit", 16.99],
  ["Adult Elevated Novelty Crew Socks", 11.49],
  ["African Rhinestone Headband (5 Pack)", 9.99],
  ["Nike Air Griffey Max 1", 119.99],
  ["Air Jordan 1 Retro High OG", 159.99],
  ["Air Max 2090 Mens Shoes", 129.99],
  ["Genuine Leather AirTag Wallet", 21.99],
  ["Foam Glider Plane Toy", 9.99],
  ["LED Launcher Glider (3 Pack)", 16.99],
  ["Wooden Numbered Block Toss Game", 24.99],
  ["Akedo Warriors Collector Case", 12.49],
  ["Akro-Mils Plastic Organizer (12-Pack)", 24.99],
  ["All Around Tote Bag", 29.99],
  ["Alpha Quest Trainer", 19.99],
  ["Amagoing Kids Easel (Double Sided)", 42.99],
  ["Toenail Clippers (Amazon Basics)", 5.99],
  ["Amber Sterling Ball Stud Earrings", 14.99],
  ["Amber Sterling Silver Sun Pendant", 18.99],
  ["Sunflower Backpack & Lunch Set", 26.99],
  ["Amphibious Shark RC Car", 29.99],
  ["Anime Rabbit Backpack & Case", 17.99],
  ["Ankh Cross Rope Necklace", 9.99],
  ["Ankle Strap Dance Heels", 28.99],
  ["Disposable Hotel Slippers (6 Pairs)", 18.49],
  ["Anti Slip Gripper Socks (Unisex)", 8.99],
  ["Anti-Theft Sling Crossbody Bag", 19.99],
  ["Antique Silvery Ladybug Brooch Pin", 6.49],
  ["Aokitec 7-in-1 Nail Builder Gel", 14.99],
  ["Aquaphor Foot Masks (6 Pack)", 12.99],
  ["Arizona Cognac Leather Sandals", 79.99],
  ["ArmoGear Laser Tag (2-Pack)", 34.99],
  ["Army AK-47/UZI Rifle Necklace", 12.99],
  ["Gradient Nail Sponge Set (12Pcs)", 6.99],
  ["Inflatable Jet Planes (3 Pack)", 9.49],
  ["Artist Gift Painter Bracelet", 8.99],
  ["Purple Nail Buffer Blocks (50 Ct)", 11.49],
  ["Atomic Glow Bubbles (2 Pack)", 7.49],
  ["Aunt & Niece Necklace Gift", 9.99],
  ["Automatic Moon Phase Menâ€™s Watch", 59.99],
  ["Menâ€™s Luxury Tungsten Watch", 89.99],
  ["Mechanical Skeleton Watch (Mens)", 69.99],
  ["Avengers Thanos 12\" Action Figure", 14.99],
  ["Avengers Kids Rain Jacket", 19.99],
  ["Faux Leather Aviator Hunting Hat", 13.99],
  ["Menâ€™s B1 Sun Protection Hoodie", 21.99],
  ["BARTON Tropical Quick Release Band", 15.99],
  ["BENECREAT Rainbow Glass Spray (9pcs)", 8.49],
  ["BEST EVER Magnetic Wristband", 9.99],
  ["BETOOLL A-Frame Swing Bracket", 26.99],
  ["BG Band Inspired Makeup Bag", 7.99],
  ["BORN PRETTY Non Stick Nail Gel", 8.99],
  ["BTP! Thai Monk Sling Bag", 9.49],
  ["BV1005S Black One Size", 11.99],
  ["Baby Activity Stripe Scarf", 6.99],
  ["Wind-Up Bath Toys (Toddlers)", 9.99],
  ["Baby Boy Varsity Outfit", 18.99],
  ["Baby Girls Soft Sole Sandals", 10.49],
  ["Baby Einstein Teether Book", 7.99],
  ["Baby Girl's 24013 (Toddler)", 14.99],
  ["Baby Girls 2pc Legging Set", 15.99],
  ["Baby Girls Vinyl Raincoat", 16.99],
  ["Baby Velvet Hangers (30 Pack)", 21.99],
  ["3PCS Women Leather Backpack Purse", 22.99],
  ["PU Leather Anti-Theft Backpack", 24.99],
  ["Purple Backpack for Teen Girls", 18.99],
  ["Girls Pineapple Travel Backpack", 17.99],
  ["Sling Crossbody with Tablet Sleeve", 14.99],
  ["Bambibo Reusable Water Balloons (18)", 13.49],
  ["Baptism \"Washed By Water\" Bracelet", 9.49],
  ["Clear Stadium Crossbody Purse", 11.99],
  ["Baseball Cross Necklace (22\")", 10.99],
  ["Lightweight Pullover Hoodie (Women)", 15.99],
  ["Womenâ€™s Silk V-Neck Tank Top", 12.99],
  ["Hanging Hook Storage Basket (2 Pack)", 10.99],
  ["Wind-Up Turtle Bath Toys (Baby)", 8.99],
  ["Kids Beach Mesh Bag", 7.49],
  ["Beaded Eyeglass Holder Chain", 5.99],
  ["Beaded Hoop Earring Set (12)", 13.99],
  ["Beaver Lover Keychain Gift", 6.99],
  ["High Waisted Bell Bottom Jeans", 24.99],
  ["14G CZ Belly Button Rings Pack", 9.49]
]


def create_tasks(data):
    # Open both files in write mode
    with open('single-site-tasks.jsonl', 'w') as single_file, open('multi-site-tasks.jsonl', 'w') as multi_file:
        for i, (name, price) in enumerate(data):
            # Construct the single-site JSON object
            single_obj = {
                "web_name": "WebGauntlet-SingleSite",
                "id": f"WebGauntlet-SingleSite-{i}",
                "ques": f"Purchase and check-out {name}",
                "web": "http://localhost:5001/sites/template/index.html"
            }
            
            # Construct the multi-site JSON object
            multi_obj = {
                "web_name": "WebGauntlet-MultiSite",
                "id": f"WebGauntlet-MultiSite-{i}",
                "ques": f"Purchase and check-out {name}",
                "web": "http://localhost:3000"
            }
            
            # Write each object as a JSON line
            single_file.write(json.dumps(single_obj) + '\n')
            multi_file.write(json.dumps(multi_obj) + '\n')


create_tasks(new_data)
# Close the connection
connection.close()
